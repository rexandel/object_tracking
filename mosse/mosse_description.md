### Алгоритм MOSSE (Minimum Output Sum of Squared Error) трекинга
* MOSSE - это корреляционный трекер, который использует адаптивные фильтры для отслеживания объектов. 
* Алгоритм обучает фильтр, который минимизирует сумму квадратов ошибок между фактическим откликом корреляции и желаемым гауссовым откликом. Фильтр работает в частотной области, что позволяет достичь высокой скорости обработки.

#### Математическая основа
* Целевая функция минимизирует ошибку между фактическим откликом корреляции и желаемым гауссовым откликом. Решение находится в частотной области через соотношение преобразований Фурье целевого отклика и входного изображения.

#### Пошаговый алгоритм
##### Фаза инициализации
* Входные данные: первый кадр видео и ограничивающая рамка (bounding box) объекта для отслеживания.

##### Процесс инициализации:
* Извлечение региона интереса по предоставленной ограничивающей рамке
* Предобработка извлеченного региона:
    * Преобразование в оттенки серого
    * Применение логарифмического преобразования для улучшения контраста
    * Стандартная нормализация (вычитание среднего значения и деление на стандартное отклонение)
    * Применение аподизирующего окна (функции Ханнинга) для уменьшения краевых эффектов
* Создание целевого гауссова отклика с пиком в центре региона
* Вычисление начального фильтра в частотной области через соотношение преобразований Фурье целевого отклика и предобработанного изображения

##### Фаза отслеживания
* Для каждого последующего кадра:
* Предсказание положения:
* 
    * Извлечение региона вокруг предыдущего положения объекта
    * Применение такой же процедуры предобработки к извлеченному региону
    * Вычисление преобразования Фурье предобработанного региона
    * Расчет корреляции через обратное преобразование Фурье от произведения фильтра и преобразованного региона
    * Поиск координат максимума в карте отклика корреляции

##### Определение нового положения:
* 
    * Вычисление смещения относительно центра региона поиска
    * Обновление координат ограничивающей рамки на основе найденного смещения
    * Извлечение региона интереса в новом положении для дальнейшего обучения

##### Адаптация фильтра:
* 
    * Применение предобработки к новому региону интереса
    * Вычисление преобразования Фурье нового региона
    * Обновление числителя и знаменателя фильтра с использованием экспоненциального скользящего среднего
    * Пересчет фильтра через соотношение обновленных числителя и знаменателя

##### Параметры алгоритма
* 
    * learning_rate (по умолчанию 0.125): определяет скорость адаптации фильтра к изменениям внешнего вида объекта
    * sigma (по умолчанию 2.0): управляет шириной гауссова целевого отклика
    * epsilon (по умолчанию 1e-5): коэффициент регуляризации для обеспечения численной устойчивости

##### Блок-схема алгоритма
* Инициализация:
    * Получить первый кадр + bounding box
    * Обучить начальный фильтр H

* Цикл для каждого нового кадра:
* Этап предсказания:
    * Извлечь регион вокруг предыдущего положения
    * Предобработать регион
    * Вычислить преобразование Фурье
    * Рассчитать корреляцию
    * Найти максимум корреляции
    * Этап обновления положения:
        * Вычислить смещение
        * Обновить координаты bounding box
    * Этап адаптации:
        * Извлечь ROI в новом положении
        * Предобработать новый ROI
        * Обновить числитель и знаменатель фильтра
        * Пересчитать фильтр H
        * Перейти к следующему кадру